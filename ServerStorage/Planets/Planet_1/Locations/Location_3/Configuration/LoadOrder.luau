--[[
================================================================================
KOSMICMAZER ‚Äî Location_1 Load Order Configuration
================================================================================

Purpose: Defines the loading order for Location_1 content
Version: 2.0
Location: Planet_1 / Location_1 (–°–∞–¥–æ—á–æ–∫)

Features:
- Priority-based loading for Location Workspace objects
- Location-specific server scripts loading order
- Location-specific client scripts loading order
- Configurable timeout and verification settings

API:
- LoadOrder.GetWorkspacePriority(objectName): Returns priority for object
- LoadOrder.GetServerScriptPriority(scriptName): Returns priority for script
- LoadOrder.GetClientScriptPriority(scriptName): Returns priority for script
- LoadOrder.GetServerScriptAction(scriptName): Returns "require" or "clone"
- LoadOrder.SortObjects(objects): Returns sorted array by priority

Calls to:
- EnvironmentLoader: Reads this config during LoadPlanetEnvironment()
- LoadOrderProcessor: Processes this configuration

Called from:
- EnvironmentLoader.LoadPlanetEnvironment()

Dependencies:
- ServerStorage.Planets.Planet_1.Locations.Location_1.Workspace
- ServerStorage.Planets.Planet_1.Locations.Location_1.Scripts
- ServerStorage.Planets.Planet_1.Scripts (Planet-level scripts)

ChangeLog:
- Version 2.0: Added ServerScripts, ClientScripts, Settings sections
- Version 1.0: Initial implementation (WorkspaceObjects only)

================================================================================
]]

--[[
================================================================================
–Ü–ù–°–¢–†–£–ö–¶–Ü–Ø –ó –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø
================================================================================

üìã –°–¢–†–£–ö–¢–£–†–ê –ö–û–ù–§–Ü–ì–£–†–ê–¶–Ü–á:

LoadOrder –Ω–∞ —Ä—ñ–≤–Ω—ñ –ª–æ–∫–∞—Ü—ñ—ó –≤–∏–∑–Ω–∞—á–∞—î –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:

1. WorkspaceObjects - –æ–±'—î–∫—Ç–∏ –∑ –ø–∞–ø–∫–∏ Location/Workspace/
   –ö–æ–ø—ñ—é—é—Ç—å—Å—è –≤ game.Workspace
   –ü—Ä–∏–∫–ª–∞–¥: Baseplate, Buildings, Props, NPCs, SpawnLocation

2. ServerScripts - —Å–∫—Ä–∏–ø—Ç–∏ –ª–æ–∫–∞—Ü—ñ—ó –∑ Scripts/Server/
   –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è —Ü—ñ—î—ó –ª–æ–∫–∞—Ü—ñ—ó
   –ü—Ä–∏–∫–ª–∞–¥: LocationGameServer, ResourceController

3. ClientScripts - –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ —Å–∫—Ä–∏–ø—Ç–∏ –∑ Scripts/Client/
   UI —Ç–∞ –ª–æ–≥—ñ–∫–∞ –¥–ª—è —Ü—ñ—î—ó –ª–æ–∫–∞—Ü—ñ—ó
   –ü—Ä–∏–∫–ª–∞–¥: LocationUI, DialogSystem, InteractionPrompts

‚öôÔ∏è –ü–†–ê–í–ò–õ–ê –ü–†–Ü–û–†–ò–¢–ï–¢–£:

- 1-100: –ë–∞–∑–æ–≤–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Baseplate, terrain)
- 101-500: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (Buildings, NPCs, game logic)
- 501-998: –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç (Props, effects, specialized UI)
- 999: SpawnLocation —Ç–∞ –∫—Ä–∏—Ç–∏—á–Ω—ñ —Ñ—ñ–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–∏ (–ó–ê–í–ñ–î–ò –æ—Å—Ç–∞–Ω–Ω—ñ–º!)
- 500: –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

üìù –¢–ò–ü–û–í–Ü –û–ë'–Ñ–ö–¢–ò –¢–ê –á–• –ü–†–Ü–û–†–ò–¢–ï–¢–ò:

Baseplate/Terrain     ‚Üí 1     (–ø—ñ–¥–ª–æ–≥–∞ –∑–∞–≤–∂–¥–∏ –ø–µ—Ä—à–∞)
Buildings             ‚Üí 100   (–±—É–¥—ñ–≤–ª—ñ –Ω–∞ –ø—ñ–¥–ª–æ–∑—ñ)
Props                 ‚Üí 200   (–¥–µ–∫–æ—Ä–∞—Ü—ñ—ó –ø—ñ—Å–ª—è –±—É–¥—ñ–≤–µ–ª—å)
NPCs                  ‚Üí 300   (–ø–µ—Ä—Å–æ–Ω–∞–∂—ñ –≤ –≥–æ—Ç–æ–≤–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ)
InteractionObjects    ‚Üí 400   (—ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ –æ–±'—î–∫—Ç–∏)
Effects              ‚Üí 500   (–≤—ñ–∑—É–∞–ª—å–Ω—ñ –µ—Ñ–µ–∫—Ç–∏)
SpawnLocation        ‚Üí 999   (–ó–ê–í–ñ–î–ò –æ—Å—Ç–∞–Ω–Ω—ñ–º!)

üéÆ –ü–†–ò–ö–õ–ê–î SERVERSCRIPTS:

{name = "LocationGameServer", priority = 1, action = "require", 
 description = "–ì–æ–ª–æ–≤–Ω–∞ —ñ–≥—Ä–æ–≤–∞ –ª–æ–≥—ñ–∫–∞ –ª–æ–∫–∞—Ü—ñ—ó"},

{name = "ResourceController", priority = 2, action = "require", 
 description = "–ö–µ—Ä—É–≤–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏"},

{name = "QuestManager", priority = 3, action = "require", 
 description = "–°–∏—Å—Ç–µ–º–∞ –∫–≤–µ—Å—Ç—ñ–≤"},

üíª –ü–†–ò–ö–õ–ê–î CLIENTSCRIPTS:

{name = "LocationUI", priority = 1, 
 description = "–û—Å–Ω–æ–≤–Ω–∏–π UI –ª–æ–∫–∞—Ü—ñ—ó"},

{name = "DialogSystem", priority = 2, 
 description = "–°–∏—Å—Ç–µ–º–∞ –¥—ñ–∞–ª–æ–≥—ñ–≤ –∑ NPC"},

{name = "InteractionPrompts", priority = 3, 
 description = "–ü—ñ–¥–∫–∞–∑–∫–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –æ–±'—î–∫—Ç–∞–º–∏"},

‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û:
- SpawnLocation –ó–ê–í–ñ–î–ò –º–∞—î –±—É—Ç–∏ priority = 999
- –Ø–∫—â–æ –æ–±'—î–∫—Ç –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–Ω—à–æ–≥–æ, –¥–∞–π—Ç–µ –π–æ–º—É –±—ñ–ª—å—à–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç
- Terrain/Baseplate –∑–∞–≤–∂–¥–∏ –ø–µ—Ä—à–∏–º–∏ (priority = 1)
- LocationGameServer —á–∞—Å—Ç–æ –ø–æ—Ç—Ä–µ–±—É—î PlanetConfig –∑ Planet-level

üîÑ –ü–û–°–õ–Ü–î–û–í–ù–Ü–°–¢–¨ –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø:
1. Planet LoadOrder (PlanetConfig, Planet scripts)
2. Location LoadOrder (LocationGameServer, Location objects)
3. LocationGameServer.Initialize() –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

üìö –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: ReplicatedStorage/Docs/LoadOrderSystem.luau

================================================================================
]]

local LoadOrder = {}

LoadOrder.Version = "2.0"

-- –ü–æ—Ä—è–¥–æ–∫ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –æ–±'—î–∫—Ç—ñ–≤ –∑ Location/Workspace/ ‚Üí game.Workspace
LoadOrder.WorkspaceObjects = {
	{name = "Baseplate", priority = 1, description = "Ground/terrain"},
	{name = "Buildings", priority = 2, description = "Location buildings"},
	{name = "Props", priority = 3, description = "Decorative objects"},
	{name = "NPCs", priority = 4, description = "NPC characters"},
	{name = "SpawnLocation", priority = 999, description = "Player spawn point (must load last)"},
	-- Add more objects here with their priorities
}

-- –ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–æ–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∑ Location/Scripts/Server/
LoadOrder.ServerScripts = {
	{name = "LocationGameServer", priority = 1, action = "require", description = "Location game logic"},
	{name = "ResourceController", priority = 2, action = "require", description = "Resource management"},
	-- ModuleScripts: action = "require" (loaded as modules)
	-- Scripts: action = "clone" (copied to Workspace)
	-- Add more scripts here
}

-- –ü–æ—Ä—è–¥–æ–∫ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤ –∑ Location/Scripts/Client/ ‚Üí StarterPlayerScripts
LoadOrder.ClientScripts = {
	{name = "LocationUI", priority = 1, description = "Location UI controller"},
	{name = "DialogSystem", priority = 2, description = "NPC dialogs"},
	{name = "InteractionPrompts", priority = 3, description = "Object interaction prompts"},
	-- Add more client scripts here
}

-- –ó–∞–≥–∞–ª—å–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
LoadOrder.Settings = {
	LoadTimeout = 10,  -- Maximum time to wait for loading (seconds)
	EnableParallelLoading = false,  -- Load items in parallel (experimental)
	VerifyAfterLoad = true,  -- Verify all objects loaded successfully
}

-- Helper function to get priority for a Workspace object
function LoadOrder.GetWorkspacePriority(objectName: string): number
	for _, entry in ipairs(LoadOrder.WorkspaceObjects) do
		if entry.name == objectName then
			return entry.priority
		end
	end
	return 500  -- Default priority for unlisted objects
end

-- Helper function to get priority for a Server script
function LoadOrder.GetServerScriptPriority(scriptName: string): number
	for _, entry in ipairs(LoadOrder.ServerScripts) do
		if entry.name == scriptName then
			return entry.priority
		end
	end
	return 500
end

-- Helper function to get priority for a Client script
function LoadOrder.GetClientScriptPriority(scriptName: string): number
	for _, entry in ipairs(LoadOrder.ClientScripts) do
		if entry.name == scriptName then
			return entry.priority
		end
	end
	return 500
end

-- Helper function to get script action (require/clone)
function LoadOrder.GetServerScriptAction(scriptName: string): string
	for _, entry in ipairs(LoadOrder.ServerScripts) do
		if entry.name == scriptName then
			return entry.action or "require"  -- Default to require
		end
	end
	return "require"
end

-- Helper function to sort objects by load order
function LoadOrder.SortObjects(objects: {Instance}): {Instance}
	local sorted = {}
	for _, obj in ipairs(objects) do
		table.insert(sorted, obj)
	end

	table.sort(sorted, function(a, b)
		return LoadOrder.GetWorkspacePriority(a.Name) < LoadOrder.GetWorkspacePriority(b.Name)
	end)

	return sorted
end

-- Legacy compatibility: alias for WorkspaceObjects
LoadOrder.ORDER = LoadOrder.WorkspaceObjects
LoadOrder.GetPriority = LoadOrder.GetWorkspacePriority

return LoadOrder
