--[[
================================================================================
KOSMICMAZER ‚Äî System Test
================================================================================

Purpose: Monitors system health and performance
Version: 1.1

Features:
- Tracks system uptime
- Monitors player count
- Logs error occurrences
- Provides periodic status reports

API:
- None (self-contained monitoring service)

Calls to:
- Players service: GetPlayers()
- LogService: MessageOut event

Called from:
- Game initialization system

Events:
- LogService.MessageOut: Monitors error messages

Dependencies:
- Players service
- RunService (for Studio detection)
- LogService (for error monitoring)

ChangeLog:
- Initial implementation for system monitoring

================================================================================
]]

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local systemStats = {
    startTime = tick(),
    totalPlayers = 0,
    loadingPlayers = 0,
    errors = 0
}

local function logSystemStatus()
    local currentTime = tick()
    local uptime = currentTime - systemStats.startTime
    
    print("[System] === –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º–∏ ===")
    print("[System] ‚è±Ô∏è –ß–∞—Å —Ä–æ–±–æ—Ç–∏:", string.format("%.1f", uptime), "—Å–µ–∫—É–Ω–¥")
    print("[System] üë• –ì—Ä–∞–≤—Ü—ñ–≤:", #Players:GetPlayers())
    print("[System] üõ†Ô∏è Studio:", RunService:IsStudio())
    print("[System] ‚ùå –ü–æ–º–∏–ª–æ–∫:", systemStats.errors)
    print("[System] =====================")
end

-- Log status every 30 seconds
task.spawn(function()
    while true do
        task.wait(30)
        logSystemStatus()
    end
end)

-- Monitor for errors
local function onError(message, stack)
    systemStats.errors = systemStats.errors + 1
    warn("[System] ‚ùå –ü–æ–º–∏–ª–∫–∞:", message)
end

-- Connect to error events (if available)
if game:GetService("LogService") then
    game:GetService("LogService").MessageOut:Connect(function(message, messageType)
        if messageType == Enum.MessageType.MessageError then
            onError(message, "")
        end
    end)
end

-- Initial status
print("[System] üöÄ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–∏ –∑–∞–ø—É—â–µ–Ω–æ")
logSystemStatus()

-- Test teleportation event communication
spawn(function()
    task.wait(5) -- Wait for system to initialize
    
    print("[System] üß™ –¢–µ—Å—Ç –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü—ñ—ó...")
    
    local Players = game:GetService("Players")
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    
    local players = Players:GetPlayers()
    if #players > 0 then
        local testPlayer = players[1]
        print("[System] üë§ –¢–µ—Å—Ç –∑ –≥—Ä–∞–≤—Ü–µ–º:", testPlayer.Name)
        
        local teleportEvent = ReplicatedStorage:FindFirstChild("TeleportationEvent")
        if teleportEvent then
            print("[System] üì° –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ—ó –ø–æ–¥—ñ—ó...")
            
            local testData = {
                locations = {
                    {
                        PlanetId = "SpaceStation",
                        LocationId = "SpaceStation",
                        DisplayName = "üöÄ Test Teleport",
                        PlanetName = "Space",
                        SpawnPoint = CFrame.new(0, 3, 0),
                        TeleportPoint = CFrame.new(0, 3, 0)
                    }
                },
                player = testPlayer.Name
            }
            
            local success = pcall(function()
                teleportEvent:FireClient(testPlayer, "ShowTeleportUI", testData)
            end)
            
            if success then
                print("[System] ‚úÖ –¢–µ—Å—Ç–æ–≤—É –ø–æ–¥—ñ—é –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ")
            else
                warn("[System] ‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ—Å—Ç–æ–≤—É –ø–æ–¥—ñ—é")
            end
        else
            warn("[System] ‚ùå TeleportationEvent –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        end
    else
        print("[System] üì≠ –ù–µ–º–∞—î –≥—Ä–∞–≤—Ü—ñ–≤ –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")
    end
end)